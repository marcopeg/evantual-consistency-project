- table:
    schema: public
    name: cache_products
  select_permissions:
  - role: client
    permission:
      columns:
      - created_at
      - etag_cache
      - etag_sot
      - id
      - is_deleting
      - is_updating
      - price
      - qt_available
      - qt_booked
      - title
      - updated_at
      filter: {}
  update_permissions:
  - role: client
    permission:
      columns:
      - price
      - qt_available
      - qt_booked
      - title
      filter: {}
      check: null
      set:
        is_updating: "true"
        etag_cache: now()
  event_triggers:
  - name: on_cache_products_change
    definition:
      enable_manual: false
      delete:
        columns: '*'
      update:
        columns:
        - title
        - price
        - qt_booked
        - qt_available
        - is_updating
        - is_deleting
        - etag_cache
    retry_conf:
      num_retries: 0
      interval_sec: 10
      timeout_sec: 60
    webhook_from_env: EVT_PRODUCTS_CACHE_UPDATE
- table:
    schema: public
    name: changelog
  insert_permissions:
  - role: sot_counters
    permission:
      check: {}
      set:
        schema: custom
        table: custom
      columns:
      - new_data
      - operation
      backend_only: false
  - role: sot_products
    permission:
      check: {}
      set:
        schema: custom
        table: custom
      columns:
      - new_data
      - operation
      backend_only: false
- table:
    schema: public
    name: sot_counters
  insert_permissions:
  - role: sot_counters
    permission:
      check: {}
      set:
        updated_at: now()
        created_at: now()
      columns:
      - counter_id
      - product_id
      - value
      backend_only: false
  select_permissions:
  - role: sot_counters
    permission:
      columns:
      - product_id
      - value
      - counter_id
      - created_at
      - updated_at
      filter: {}
      limit: 10
  update_permissions:
  - role: sot_counters
    permission:
      columns:
      - value
      filter: {}
      check: {}
      set:
        updated_at: now()
- table:
    schema: public
    name: sot_listings
- table:
    schema: public
    name: sot_products
  insert_permissions:
  - role: sot_products
    permission:
      check: {}
      set:
        updated_at: now()
        created_at: now()
      columns:
      - price
      - title
      backend_only: false
  select_permissions:
  - role: sot_products
    permission:
      columns:
      - created_at
      - id
      - price
      - title
      - updated_at
      filter: {}
      limit: 1
  update_permissions:
  - role: sot_products
    permission:
      columns:
      - price
      - title
      filter: {}
      check: null
      set:
        updated_at: now()
  delete_permissions:
  - role: sot_products
    permission:
      filter: {}
